// e.g.
// cargo test --package cck-asymmetric --test ed25519 --  --nocapture
// cargo test --package cck-asymmetric --test ed25519 -- ed25519_sign --nocapture

#[test]
fn ed25519_sign() {
    const PRIVATE_KEY: [u8; 32] = [
        57, 118, 167, 209, 148, 246, 9, 153, 43, 233, 24, 70, 81, 50, 244, 8, 216, 134, 77, 24, 45,
        63, 110, 114, 213, 83, 48, 35, 77, 224, 42, 141,
    ];

    const PUBLIC_KEY: [u8; 32] = [
        28, 42, 127, 159, 71, 64, 94, 77, 241, 213, 229, 43, 132, 111, 143, 16, 7, 248, 123, 1,
        188, 192, 21, 231, 126, 118, 244, 155, 178, 217, 125, 141,
    ];

    const SIGNATURE: [u8; 64] = [
        210, 243, 117, 244, 95, 114, 96, 127, 143, 80, 47, 53, 74, 49, 11, 110, 193, 37, 103, 126,
        57, 116, 248, 38, 213, 166, 145, 75, 189, 249, 91, 43, 237, 231, 158, 20, 179, 63, 70, 116,
        61, 42, 150, 76, 39, 30, 209, 155, 101, 45, 82, 165, 253, 4, 226, 19, 0, 198, 57, 111, 177,
        6, 237, 12,
    ];

    // Hello, world!: [72, 101, 108, 108, 111, 44, 32, 119, 111, 114, 108, 100, 33]
    const MESSAGE: [u8; 13] = [72, 101, 108, 108, 111, 44, 32, 119, 111, 114, 108, 100, 33];

    assert_eq!(
        cck_asymmetric::ed25519::sign(&PRIVATE_KEY, &MESSAGE).unwrap(),
        SIGNATURE
    );
}

#[test]
fn ed25519_verify() {
    const PRIVATE_KEY: [u8; 32] = [
        57, 118, 167, 209, 148, 246, 9, 153, 43, 233, 24, 70, 81, 50, 244, 8, 216, 134, 77, 24, 45,
        63, 110, 114, 213, 83, 48, 35, 77, 224, 42, 141,
    ];

    const PUBLIC_KEY: [u8; 32] = [
        28, 42, 127, 159, 71, 64, 94, 77, 241, 213, 229, 43, 132, 111, 143, 16, 7, 248, 123, 1,
        188, 192, 21, 231, 126, 118, 244, 155, 178, 217, 125, 141,
    ];

    const SIGNATURE: [u8; 64] = [
        210, 243, 117, 244, 95, 114, 96, 127, 143, 80, 47, 53, 74, 49, 11, 110, 193, 37, 103, 126,
        57, 116, 248, 38, 213, 166, 145, 75, 189, 249, 91, 43, 237, 231, 158, 20, 179, 63, 70, 116,
        61, 42, 150, 76, 39, 30, 209, 155, 101, 45, 82, 165, 253, 4, 226, 19, 0, 198, 57, 111, 177,
        6, 237, 12,
    ];

    // Hello, world!: [72, 101, 108, 108, 111, 44, 32, 119, 111, 114, 108, 100, 33]
    const MESSAGE: [u8; 13] = [72, 101, 108, 108, 111, 44, 32, 119, 111, 114, 108, 100, 33];

    assert_eq!(
        cck_asymmetric::ed25519::verify(&PUBLIC_KEY, &MESSAGE, &SIGNATURE).is_ok(),
        true,
    );
}
